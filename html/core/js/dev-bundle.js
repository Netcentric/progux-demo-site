!function(){"use strict";const e=e=>0 in navigator?"unknown":e.indexOf(navigator.connection.effectiveType)>=0?"slow":"fast";var n={settings:{lowRAM:4,lowCPU:4,slowConnectionTypes:["slow-2g","2g","3g"]},sessionStorageKey:"progressiveUserSettings",sessionStorageDevKey:"progressiveUserDevSettings",defaultDevSettings:{isDraggable:1,mode:"closed",posTop:20,posLeft:20}};const t=Object.assign(n),o=e=>null!==sessionStorage.getItem(e),a=e=>{try{return o(e)?JSON.parse(sessionStorage.getItem(e)):{}}catch(e){console.log(e)}},s=(e,n)=>{l(e,n),function(e){const n=a(e),t=document.getElementsByTagName("html")[0];for(const[e,o]of Object.entries(n)){const n=`${e}-${o}`;t.classList.add(n)}}(n)},l=(e,n)=>{try{sessionStorage.setItem(n,JSON.stringify(e))}catch(e){console.log(e)}};const i=()=>{const{lowRAM:n,lowCPU:o,slowConnectionTypes:a}=t.settings;return{memoryLevel:(e=>{if(0 in navigator)return"unknown";const n=navigator.deviceMemory;return n===e?"mid":n>e?"high":"low"})(n),cpuLevel:(e=>{if(0 in navigator)return"unknown";const n=navigator.hardwareConcurrency;return n===e?"mid":n>e?"high":"low"})(o),connectionSpeed:e(a),saveData:"connection"in navigator?navigator.connection.saveData:0,reducedMotion:window.matchMedia("(prefers-reduced-motion: reduce)").matches,tracking:"doNotTrack"in navigator&&"1"===navigator.doNotTrack?"disabled":"enabled"}},c="settingsModal",d=c,r="settingsModal--open",u="settingsModal--closed",g="settingsModal--banner",p="settingsModal__header",v="settingsModal__title",m="settingsModal__form",$="settingsModal__submit",f="settingsModal__options",h="settingsModal__option",y="settingsModal__controller",b="settingsModal__controller--toggle",w="settingsModal__controller--options",k="settingsModal__controller--view",M="settingsModal__parameter",S="settingsModal__parameterValue",_="settingsModal__parameterInput",L="settingsModal__input",D="settingsModal__label",E="settingsModal__toggle",x="settingsModal__slider",I="settingsModal__icon",V="settingsModal__closeIcon",T="settingsModal__openIcon",O={settingsModalSubmitId:"settingsModalSubmit",settingsModalFormId:"settingsModalForm"},q={title:"memory level",id:"settingsModalMemoryLevel",valuePrefix:"memory-level",options:[{type:"radio",id:"memory-level-low",name:"memoryLevel",value:"low",label:"low"},{type:"radio",id:"memory-level-mid",name:"memoryLevel",value:"mid",label:"mid"},{type:"radio",id:"memory-level-high",name:"memoryLevel",value:"high",label:"high"},{type:"radio",id:"memory-level-unknown",name:"memoryLevel",value:"unknown",label:"unknown"}]},A={title:"CPU level",id:"settingsModalCpuLevel",valuePrefix:"cpu-level",options:[{type:"radio",id:"cpu-level-low",name:"cpuLevel",value:"low",label:"low"},{type:"radio",id:"cpu-level-mid",name:"cpuLevel",value:"mid",label:"mid"},{type:"radio",id:"cpu-level-high",name:"cpuLevel",value:"high",label:"high"},{type:"radio",id:"cpu-level-unknown",name:"cpuLevel",value:"unknown",label:"unknown"}]},C={title:"Connection speed",id:"settingsModalConnectionSpeed",valuePrefix:"connection-speed",options:[{type:"radio",id:"connection-speed-slow",name:"connectionSpeed",value:"slow",label:"slow"},{type:"radio",id:"connection-speed-fast",name:"connectionSpeed",value:"fast",label:"fast"},{type:"radio",id:"connection-speed-unknown",name:"connectionSpeed",value:"unknown",label:"unknown"}]},j={title:"Save data",id:"saveData",name:"saveData",value:"true",checkedValue:"true",uncheckedValue:"false"},P={title:"Reduced motion",id:"reducedMotion",name:"reducedMotion",value:"true",checkedValue:"true",uncheckedValue:"false"},U={title:"Tracking",id:"tracking",name:"tracking",value:"enabled",checkedValue:"enabled",uncheckedValue:"disabled"},B={memoryLevel:q,cpuLevel:A,connectionSpeed:C},N={saveData:j,reducedMotion:P,tracking:U},K={title:"Banner view",id:"view",name:"view",value:"disabled",checkedValue:"enabled",uncheckedValue:"disabled"},F='<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24">\n  <path d="M0 0h24v24H0V0z" fill="none"/>\n  <path d="M19.43 12.98c.04-.32.07-.64.07-.98s-.03-.66-.07-.98l2.11-1.65c.19-.15.24-.42.12-.64l-2-3.46c-.12-.22-.39-.3-.61-.22l-2.49 1c-.52-.4-1.08-.73-1.69-.98l-.38-2.65C14.46 2.18 14.25 2 14 2h-4c-.25 0-.46.18-.49.42l-.38 2.65c-.61.25-1.17.59-1.69.98l-2.49-1c-.23-.09-.49 0-.61.22l-2 3.46c-.13.22-.07.49.12.64l2.11 1.65c-.04.32-.07.65-.07.98s.03.66.07.98l-2.11 1.65c-.19.15-.24.42-.12.64l2 3.46c.12.22.39.3.61.22l2.49-1c.52.4 1.08.73 1.69.98l.38 2.65c.03.24.24.42.49.42h4c.25 0 .46-.18.49-.42l.38-2.65c.61-.25 1.17-.59 1.69-.98l2.49 1c.23.09.49 0 .61-.22l2-3.46c.12-.22.07-.49-.12-.64l-2.11-1.65zM12 15.5c-1.93 0-3.5-1.57-3.5-3.5s1.57-3.5 3.5-3.5 3.5 1.57 3.5 3.5-1.57 3.5-3.5 3.5z"/>\n</svg>',z='<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 30 30">\n  <path fill-rule="evenodd" d="M30 3.021L26.979 0 15 11.979 3.021 0 0 3.021 11.979 15 0 26.979 3.021 30 15 18.021 26.979 30 30 26.979 18.021 15z"/>\n</svg>',J=e=>{const n=function(e){const{mode:n,posTop:t,posLeft:o,isDraggable:a}=e,s=`top: ${t}px; left: ${o}px;`;let l="closed"===n?d+"--closed":d+"--open";"banner"===n&&(l+=` ${d}--banner`);return`<div class="${d} ${l}"\n                 style="${s}"\n                 id="${d}" \n                 draggable="${a?"true":"false"}">`}(e),t=`<button type="submit" class="${$}" id="${O.settingsModalSubmitId}" value="Submit">Submit</button>`;return`${n}\n        ${`<div class="${p}">\n          <p class="${v}">Settings</p>\n          <span class="${I} ${V}">\n            ${z}\n          </span>\n          <span class="${I} ${T}">\n            ${F}\n          </span>\n    </div>`}\n        ${`<form class="${m}" id="${O.settingsModalFormId}">`}\n        ${R(q)}\n        ${R(A)}\n        ${R(C)}\n        ${H(j)}\n        ${H(P)}\n        ${H(U)}\n        ${t}\n        </form>\n        ${function(e,n){return`<div class="${y} ${b} ${k}">\n        <p class="${M}">${e.title}</p>\n        <label class="${E}">\n            <input type="checkbox" \n                    id="${e.id}" \n                    class="${L}"\n                    name="${e.name}" \n                    value="${"banner"===n.mode?e.checkedValue:e.uncheckedValue}"\n                    data-checked-value="${e.checkedValue}"\n                    data-unchecked-value="${e.uncheckedValue}"\n                    ${"banner"===n.mode?"checked":""}>\n            <span class="${x}"></span>\n        </label>\n    </div>`}(K,e)}\n        </div>`};function R(e){const n=function(e){let n="";for(const t of e)n+=`<li class="${h}">\n            <input type="${t.type}" id="${t.id}" class="${L}" name="${t.name}" value="${t.value}">\n            <label for="${t.id}" class="${D}">${t.label}</label>\n        </li>`;return n}(e.options);return`<div class="${y} ${w}">\n        <p class="${M}">${e.title}</p>\n        <p class="${S}"></p>\n        <ul class="${f} ${_}" id="${e.id}">\n            ${n}\n        </ul>\n    </div>`}function H(e){return`<div class="${y} ${b}">\n        <p class="${M}">${e.title}</p>\n        <p class="${S}">${e.value}</p>\n        <label class="${E} ${_}">\n            <input type="checkbox" \n                     id="${e.id}" \n                     class="${L}"\n                     name="${e.name}" \n                     value="${e.value}"\n                     data-checked-value="${e.checkedValue}"\n                     data-unchecked-value="${e.uncheckedValue}">\n            <span class="${x}"></span>\n        </label>\n    </div>`}let X,Y;function G(e){X=e.offsetX,Y=e.offsetY,e.dataTransfer.setData("text/plain",e.target.id)}function Q(e){e.preventDefault()}const{sessionStorageKey:W,sessionStorageDevKey:Z}=n;function ee(){try{const e=JSON.parse(sessionStorage.getItem(W));Object.keys(B).forEach(n=>{const t=B[n];!function(e,n){const t=[...document.querySelector("."+m).querySelectorAll(e)].find(e=>e.id===n);if(!t)return;t.setAttribute("checked","");const o=t.value,a=t.closest("."+y).querySelector("."+S);a&&(a.innerHTML=o)}(`#${t.id} input`,`${t.valuePrefix}-${e[n]}`)}),Object.keys(N).forEach(e=>function(e,n){try{const t=JSON.parse(sessionStorage.getItem(W)),o=document.querySelector("."+m).querySelector("#"+e),a=t[n];if(!["true","enabled"].includes(a))return;o.setAttribute("checked","checked")}catch(e){console.log("Unable to parse modal settings",e)}}(N[e].id,e))}catch(e){console.log("Unable to parse modal settings",e)}}function ne(e){e.stopPropagation(),e.preventDefault();!function(e){"checked"===e.getAttribute("checked")?e.removeAttribute("checked","false"):e.setAttribute("checked","checked")}(e.target.parentElement.querySelector("input"))}function te(e){const n=[...e],t=[...Object.keys(B),...Object.keys(N)],o=function(e){const n=window.location.search;if(!n)return;return n.replace("?","").split("&").map(e=>e.split("=")).filter(n=>!e.includes(n[0]))}(t),a=t.map(e=>n.find(n=>n[0]===e)||[e,N[e].uncheckedValue]);return[...o,...a].map(e=>`${e[0]}=${e[1]}`).join("&")}function oe(e){e.preventDefault();!function(e){const n=`${window.location.href.split("?")[0]}?${e}`;window.location.href=n}(te(new FormData(document.getElementById(O.settingsModalFormId))))}function ae(e,n){const t=e.querySelector("."+T),o=e.querySelector("."+V),a=e.querySelector(`.${k} .${E}`);t.addEventListener("click",()=>function(e,n){e.classList.remove(""+u),e.classList.add(""+r),n.mode="open",l(n,Z)}(e,n)),o.addEventListener("click",()=>function(e,n){e.classList.remove(""+r),e.classList.add(""+u),n.mode="closed",l(n,Z)}(e,n)),a.addEventListener("click",t=>function(e,n,t){if(e.stopPropagation(),e.preventDefault(),"checked"===e.target.parentElement.querySelector("input").getAttribute("checked"))return n.classList.add(""+g),t.mode="banner",void l(t,Z);n.classList.remove(""+g),t.mode="open",l(t,Z)}(t,e,n))}function se(e,n){e.addEventListener("dragstart",G,0),document.body.addEventListener("dragover",Q,0),document.body.addEventListener("drop",e=>function(e,n,t){const o=e.dataTransfer.getData("text"),a=document.getElementById(o),s=e.pageX-X,i=e.pageY-Y;var c,d,r;d=s,r=i,(c=a).style.top=r+"px",c.style.left=d+"px",n.posTop=i,n.posLeft=s,l(n,t),e.dataTransfer.clearData()}(e,n,Z),0)}const le=e=>{ee(),function(){const e=document.querySelectorAll("."+E),n=document.getElementById(O.settingsModalSubmitId);e.forEach(e=>{e.addEventListener("click",ne)}),n.addEventListener("click",oe)}();const n=document.querySelector("."+d),{isDraggable:t}=e;ae(n,e),t&&se(n,e)},{sessionStorageKey:ie,sessionStorageDevKey:ce,defaultDevSettings:de}=n;(()=>{const n=(()=>{const e=new URLSearchParams(window.location.search).entries(),n={};for(const t of e)n[t[0]]=t[1];return n})(),l=a(ie),c=a(ce),d=o(ie)?(()=>{const{slowConnectionTypes:n}=t.settings;return{connectionSpeed:e(n)}})():i(),r=Object.assign(l,d,n);s(r,ie),window.addEventListener("load",()=>{const e=Object.keys(c).length?c:de;document.body.insertAdjacentHTML("afterbegin",J(e)),le(e)})})()}();
